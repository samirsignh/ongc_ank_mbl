
<!DOCTYPE html>
<html lang="en">

  
<!-- Mirrored from www.bootstrapget.com/demos/templatemonster/medicare-admin-dashboard/form-inputs.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 16 Sep 2024 17:59:06 GMT -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ONGC :: Ankleshwar</title>

    <!-- Meta -->
    <meta name="description" content="Marketplace for Bootstrap Admin Dashboards">
    <meta name="author" content="Bootstrap Gallery">
    <link rel="canonical" href="https://www.bootstrap.gallery/">
    <meta property="og:url" content="https://www.bootstrap.gallery/">
    <meta property="og:title" content="Admin Templates - Dashboard Templates | Bootstrap Gallery">
    <meta property="og:description" content="Marketplace for Bootstrap Admin Dashboards">
    <meta property="og:type" content="Website">
    <meta property="og:site_name" content="Bootstrap Gallery">
    <link rel="shortcut icon" href="assets/images/icons/logo.png">

    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css">

    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">

    <!-- *************
		************ CSS Files *************
	************* -->
    <link rel="stylesheet" href="assets/fonts/remix/remixicon.css">
    <link rel="stylesheet" href="assets/css/main.min.css">
    <link rel="stylesheet" type="text/css" href="assets/customecss/dashboard.css">
    <link href="assets/local/select2/css/select2.min.css" rel="stylesheet" type="text/css" />

    <style type="text/css">
      #toast-container{
        padding-right: 130px ;
        padding-top: 30px ;;
      }
      .toast.toast-success{
        background-color: green;
      }
      .toast.toast-error{
        background-color: red;
      }
      .select2-selection.select2-selection--single{
        height: 40px !important;
      }
      .select2-selection__rendered{
        margin-top: 6px;
      }
      .select2-container--default .select2-selection--single .select2-selection__arrow{
        top: 8px;
        right: 8px;
      }
      .accordion-body .device-pills a{
        margin-right: 8px;
        margin-bottom: 10px;
        padding: 3px 5px;
      }
      .icon-box{
        box-shadow: inset 1.5px 1.5px 0px rgb(255 255 255 / 0%), inset -1.5px -1.5px 0px rgba(0, 0, 0, .1);
      }
    </style>

    <!-- *************
		************ Vendor Css Files *************
	************ -->

    <!-- Scrollbar CSS -->
    <link rel="stylesheet" href="assets/vendor/overlay-scroll/OverlayScrollbars.min.css">
  </head>

  <body>

    <!-- Page wrapper starts -->
    <div class="page-wrapper">

      <!-- App header starts -->
      <div class="app-header d-flex align-items-center">

        <!-- Toggle buttons starts -->
        <div class="d-flex">
          <button class="toggle-sidebar">
            <i class="ri-menu-line"></i>
          </button>
          <button class="pin-sidebar">
            <i class="ri-menu-line"></i>
          </button>
        </div>
        <!-- Toggle buttons ends -->

        <!-- App brand starts -->
        <div class="app-brand ms-3">
          <a href="index.html" class="d-lg-block d-none">
            <img src="assets/images/icons/logo.png" class="logo">
          </a>
        </div>
        <!-- App brand ends -->

        <!-- App header actions starts -->
        <div class="header-actions">

          <!-- Header user settings starts -->
          <div class="dropdown ms-2">
            <a id="userSettings" class="dropdown-toggle d-flex align-items-center" href="#!" role="button"
              data-bs-toggle="dropdown" aria-expanded="false">
              <div class="avatar-box"><i class="fa-solid fa-user"></i></div>
            </a>
            <div class="dropdown-menu dropdown-menu-end shadow-lg">
              <div class="px-3 py-2">
                <h6 class="m-0" id="logedin_user"></h6>
              </div>
              <div class="mx-3 my-2 d-grid">
                <a href="javascript:;" onclick="logoutSession()" class="btn btn-danger">Logout</a>
              </div>
            </div>
          </div>
          <!-- Header user settings ends -->

        </div>
        <!-- App header actions ends -->

      </div>
      <!-- App header ends -->

      <!-- Main container starts -->
      <div class="main-container">

        <!-- Sidebar wrapper starts -->
        <nav id="sidebar" class="sidebar-wrapper">

          <!-- Sidebar menu starts -->
          <div class="sidebarMenuScroll">
            <ul class="sidebar-menu">
              <li class="active current-page">
                <a href="main_dashboard.html">
                  <i class="ri-home-6-line"></i>
                  <span class="menu-text">Dashboard</span>
                </a>
              </li>
              <li class="treeview">
                <a href="#!">
                  <i class="ri-bar-chart-line"></i>
                  <span class="menu-text">Rports</span>
                </a>
                <ul class="treeview-menu">
                  <li>
                    <a href="historical_log.html">Historical Reports</a>
                  </li>
                  <li>
                    <a href="alert_log_report.html">Alert Report</a>
                  </li>
                  <li>
                    <a href="historical_graph.html">Historical Graph Report</a>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
          <!-- Sidebar menu ends -->
        </nav>
        <!-- Sidebar wrapper ends -->

        <!-- App container starts -->
        <div class="app-container">

          <!-- App hero header starts -->
          <div class="app-hero-header d-flex align-items-center">

            <!-- Breadcrumb starts -->
            <ol class="breadcrumb">
              <li class="breadcrumb-item">
                <i class="ri-home-8-line lh-1 pe-3 me-3 border-end"></i>
                <a href="#">Home</a>
              </li>
              <li class="breadcrumb-item text-primary" aria-current="page">
                Dashboard
              </li>
            </ol>
            <!-- Breadcrumb ends -->

          </div>
          <!-- App Hero header ends -->

          <!-- App body starts -->
          <div class="app-body">

            <!-- Row starts -->
            <div class="row gx-3">
              <div class="col-lg-3 col-sm-6 col-12">
                <div class="card mb-3">
                  <div class="card-body filter-card">
                    <div class="m-0">
                      <label class="form-label" for="abc4"><strong>Area</strong></label>
                      <select class="form-control select2" onchange="getSiteList(); get_dashboard_counts()" id="area_id" name="area_id" aria-label="Default select example">
                        
                      </select>
                    </div>

                    <div class="m-0 pt-2">
                      <label class="form-label" for="abc4"><strong>Installation/Site</strong></label>
                      <select class="form-control select2" onchange="getWellNames(); get_dashboard_counts();" id="site_id" name="site_id" aria-label="Default select example">
                        
                      </select>
                    </div>

                    <div class="m-0 pt-2">
                      <label class="form-label" for="abc4"><strong>Well Type</strong></label>
                      <select class="form-control select2" onchange="get_dashboard_counts()" id="well_type" name="well_type" aria-label="Default select example">
                      </select>
                    </div>

                    <div class="m-0 pt-2">
                      <label class="form-label" for="abc4"><strong>Well Name</strong></label>
                      <select class="form-control select2" onchange="get_dashboard_counts()" id="well_id" name="well_id" aria-label="Default select example">
                      </select>
                    </div>

                  </div>
                </div>
              </div>
            </div>

            <div class="row gx-3">
              <div class="col-xl-3 col-sm-6 col-12">
                <div class="card mb-3">
                  <div class="card-body total-well-card">
                    <a href="javascript:;" onclick="setIdsToSession('totalWells')">
                      <div class="d-flex align-items-center">
                        <div class="p-2 border border-primary rounded-circle me-3">
                          <div class="icon-box md bg-primary-subtle rounded-5">
                            <img height="45" src="assets/images/icons/oil.png" alt="icon-one">
                          </div>
                        </div> 
                        <div class="d-flex flex-column" style="margin-left: 15%;">
                          <h2 class="lh-1">
                            <div class="icon-box md rounded-5 bg-primary" style="width: 2.5rem;height: 2.5rem;background: linear-gradient(to right, #00203FFF, #165c51);">
                              <span style="font-size: 15px;" id="total_well"></span>
                            </div>
                          </h2>
                          <p class="m-0 welltext">Total Wells</p>
                        </div>
                      </div>
                    </a>
                  </div>
                </div>
              </div>

              <div class="col-xl-3 col-sm-6 col-12">
                <div class="card mb-3">
                  <div class="card-body flowing-well-card">
                    <a href="javascript:;" onclick="setIdsToSession('flowingWellsCard')">
                      <div class="d-flex align-items-center">
                      <div class="p-2 border border-success rounded-circle me-3">
                        <div class="icon-box md bg-success-subtle rounded-5">
                          <img height="45" src="assets/images/icons/02.png" alt="icon-one">
                        </div>
                      </div>
                      <div class="d-flex flex-column" style="margin-left: 15%;">
                        <h2 class="lh-1">
                          <div class="icon-box md rounded-5 bg-primary" style="width: 2.5rem;height: 2.5rem;background: linear-gradient(to right, #00203FFF, #165c51);">
                            <span style="font-size: 15px;" id="total_flowing_well"></span>
                          </div>
                        </h2>
                        <p class="m-0 welltext">Flowing Wells</p>
                      </div>
                    </div>
                    </a>
                  </div>
                </div>
              </div>

              <div class="col-xl-3 col-sm-6 col-12">
                <div class="card mb-3">
                  <div class="card-body non-flowing-card">
                    <a href="javascript:;" onclick="setIdsToSession('nonFlowingWells')">
                      <div class="d-flex align-items-center">
                        <div class="p-2 border border-warning rounded-circle me-3">
                          <div class="icon-box md bg-warning-subtle rounded-5">
                            <img height="45" src="assets/images/icons/04.png" alt="icon-one">
                          </div>
                        </div>
                        <div class="d-flex flex-column" style="margin-left: 15%;">
                          <h2 class="lh-1">
                            <div class="icon-box md rounded-5 bg-primary" style="width: 2.5rem;height: 2.5rem;background: linear-gradient(to right, #00203FFF, #165c51);">
                              <span style="font-size: 15px;" id="total_non_flowing_well"></span>
                            </div>
                          </h2>
                          <p class="m-0 welltext">Non-Flowing Wells</p>
                        </div>
                      </div>
                    </a>
                  </div>
                </div>
              </div>

              <div class="col-xl-3 col-sm-6 col-12">
                <div class="card mb-3">
                  <div class="card-body offline-well-card">
                    <a href="javascript:;" onclick="setIdsToSession('offlineWells')">
                      <div class="d-flex align-items-center">
                        <div class="p-2 border border-danger rounded-circle me-3">
                          <div class="icon-box md bg-danger-subtle rounded-5">
                            <img height="45" src="assets/images/icons/03.png" alt="icon-one">
                          </div>
                        </div>
                        <div class="d-flex flex-column" style="margin-left: 15%;">
                          <h2 class="lh-1">
                            <div class="icon-box md rounded-5 bg-primary" style="width: 2.5rem;height: 2.5rem;background: linear-gradient(to right, #00203FFF, #165c51);">
                              <span style="font-size: 15px;" id="Off_well"></span>
                            </div>
                          </h2>
                          <p class="m-0 welltext">Offline Wells</p>
                        </div>
                      </div>
                    </a>
                  </div>
                </div>
              </div>

              <div class="col-xl-3 col-sm-6 col-12">
                <div class="card mb-3">
                  <div class="card-body cgl-card">
                    <a href="javascript:;" onclick="setIdsToSession('cglWells')">
                      <div class="d-flex align-items-center">
                        <div class="p-2 border border-primary rounded-circle me-3">
                          <div class="icon-box md bg-primary-subtle rounded-5">
                            <img height="45" src="assets/images/icons/05.png" alt="icon-one">
                          </div>
                        </div> 
                        <div class="d-flex flex-column" style="margin-left: 15%;">
                          <h2 class="lh-1">
                            <div class="icon-box md rounded-5 bg-primary" style="width: 2.5rem;height: 2.5rem;background: linear-gradient(to right, #00203FFF, #165c51);">
                              <span style="font-size: 15px;" id="cgl_well"></span>
                            </div>
                          </h2>
                          <p class="m-0 welltext">CGL</p>
                        </div>
                      </div>
                    </a>
                  </div>
                </div>
              </div>

              <div class="col-xl-3 col-sm-6 col-12">
                <div class="card mb-3">
                  <div class="card-body igl-card">
                    <a href="igl_wells_list.html">
                      <div class="d-flex align-items-center">
                        <div class="p-2 border border-success rounded-circle me-3">
                          <div class="icon-box md bg-success-subtle rounded-5">
                            <img height="45" src="assets/images/icons/06.png" alt="icon-one">
                          </div>
                        </div>
                        <div class="d-flex flex-column" style="margin-left: 15%;">
                          <h2 class="lh-1">
                            <div class="icon-box md rounded-5 bg-primary" style="width: 2.5rem;height: 2.5rem;background: linear-gradient(to right, #00203FFF, #165c51);">
                              <span style="font-size: 15px;" id="igl_well"></span>
                            </div>
                          </h2>
                          <p class="m-0 welltext">IGL</p>
                        </div>
                      </div>
                    </a>
                  </div>
                </div>
              </div>

              <div class="col-xl-3 col-sm-6 col-12">
                <div class="card mb-3">
                  <div class="card-body self-flow-card">
                    <a href="self_flow_list.html">
                      <div class="d-flex align-items-center">
                        <div class="p-2 border border-warning rounded-circle me-3">
                          <div class="icon-box md bg-warning-subtle rounded-5">
                            <img height="45" src="assets/images/icons/09.png" alt="icon-one">
                          </div>
                        </div>
                        <div class="d-flex flex-column" style="margin-left: 15%;">
                          <h2 class="lh-1">
                            <div class="icon-box md rounded-5 bg-primary" style="width: 2.5rem;height: 2.5rem;background: linear-gradient(to right, #00203FFF, #165c51);">
                              <span style="font-size: 15px;" id="self_flow_well"></span>
                            </div>
                          </h2>
                          <p class="m-0 welltext">Self-flow Wells</p>
                        </div>
                      </div>
                    </a>
                  </div>
                </div>
              </div>

              <div class="col-xl-3 col-sm-6 col-12">
                <div class="card mb-3">
                  <div class="card-body anamolies-card">
                    <div class="d-flex align-items-center">
                      <div class="p-2 border border-danger rounded-circle me-3">
                        <div class="icon-box md bg-danger-subtle rounded-5">
                          <img height="45" src="assets/images/icons/10.png" alt="icon-one">
                        </div>
                      </div>
                      <div class="d-flex flex-column" style="margin-left: 15%;">
                        <h2 class="lh-1">
                          <div class="icon-box md rounded-5 bg-primary" style="width: 2.5rem;height: 2.5rem;background: linear-gradient(to right, #00203FFF, #165c51);">
                            <span style="font-size: 15px;">0</span>
                          </div>
                        </h2>
                        <p class="m-0 welltext">Anamolies</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row gx-3">
              <div class="col-sm-12">
                <div class="accordion mb-3" id="well_detailsAccordian">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="welldetailsaccordians">
                      <button class="accordion-button" onclick="get_dashboard_well_details()" type="button" data-bs-toggle="collapse"
                        data-bs-target="#well_details_accordians" aria-expanded="true"
                        aria-controls="well_details_accordians">
                        <div class="name-tilte">
                          <h5 class="m-0">
                            Well Details <span class="btn btn-sm well-count-head-1" id="Total_Count"></span>
                          </h5>
                        </div>
                      </button>
                    </h2>
                    <div id="well_details_accordians" class="accordion-collapse collapse"
                      aria-labelledby="welldetailsaccordians" data-bs-parent="#well_detailsAccordian">
                      <div class="accordion-body">
                        <div class="card-indicator-section">
                            <div class="box1"></div>
                            <span> Flowing Wells </span>
                            <div class="box2"></div>
                            <span> Offline Well </span>
                            <div class="box3"></div>
                            <span> Non-flowing Wells </span>
                        </div>

                        <div class="device-pills a pt-3 text-center" id="well_area_card">

                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row gx-3">
              <div class="col-sm-12">
                <div class="accordion mb-3" id="asset_gis_map_accordian">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="assetGIS_map_accordians">
                      <button class="accordion-button" onclick="initMap()" type="button" data-bs-toggle="collapse"
                        data-bs-target="#asset_gisMapAccordian" aria-expanded="true"
                        aria-controls="asset_gisMapAccordian">
                        <div class="name-tilte">
                          <h5 class="m-0">
                            Asset GIS Map
                          </h5>
                        </div>
                      </button>
                    </h2>
                    <div id="asset_gisMapAccordian" class="accordion-collapse collapse"
                      aria-labelledby="assetGIS_map_accordians" data-bs-parent="#asset_gis_map_accordian">
                      <div class="accordion-body">
                        <div class="card-indicator-section">
                            <div class="box1"></div>
                            <span> Flowing Wells </span>
                            <div class="box2"></div>
                            <span> Offline Well </span>
                            <div class="box3"></div>
                            <span> Non-flowing Wells </span>
                        </div>

                        <div class="d-flex gap-2 pt-3">
                          <div class="mt-2" id="mymap" style="width:100%;height: 400px;"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Row ends -->

          </div>
          <!-- App body ends -->

          <!-- App footer starts -->
          <div class="app-footer bg-white">
            <span>© Copyright, Iotas Solutions Pvt Ltd, All Right Reserve. </span>
          </div>
          <!-- App footer ends -->

        </div>
        <!-- App container ends -->

      </div>
      <!-- Main container ends -->

    </div>
    <!-- Page wrapper ends -->

    <!-- *************
			************ JavaScript Files *************
		************* -->
    <!-- Required jQuery first, then Bootstrap Bundle JS -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/moment.min.js"></script>

    <!-- *************
			************ Vendor Js Files *************
		************* -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>  

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA-_rv9bXIPPVsYV0TQ5NxUMg96WdP9_LM"></script>

    <script src="assets/local/select2/js/select2.min.js"></script>

    <!-- Overlay Scroll JS -->
    <script src="assets/vendor/overlay-scroll/jquery.overlayScrollbars.min.js"></script>
    <script src="assets/vendor/overlay-scroll/custom-scrollbar.js"></script>
    <script type="text/javascript" src="inc/paths.js"></script>

    <!-- Custom JS files -->
    <script src="assets/js/custom.js"></script>
    <!-- <script src="inc/sidebarmenu.html"></script> -->

    <script type="text/javascript">
      toastr.options = {
        "closeButton": true,
        "newestOnTop": false,
        "progressBar": true,
        "positionClass": "toast-top-center",
        "preventDuplicates": false,
        "onclick": null,
        "showDuration": "1000",
        "hideDuration": "2000",
        "timeOut": "1500",
        "extendedTimeOut": "2000",
        "showEasing": "swing",
        "hideEasing": "linear",
        "showMethod": "fadeIn",
        "hideMethod": "fadeOut"
      }


      $(document).ready(function() 
      {
        $(".select2").select2();
      });
    </script>

    <script>

      let sessionUserData = localStorage.getItem('userData');
      let userData = JSON.parse(sessionUserData);
      // console.log(userData);
      $(document).ready(function() {
        let company_id = userData.company_id;
        let assets_id = userData.assets_id;
        // area list section
        $.ajax({
            url: api_path + "Area_master/AreaList",
            type: "POST",
            data:{company_id:company_id, assets_id:assets_id},
            headers: { 
                "x-api-key": "Qm0Lkq9m8JRiGPxO56HNmD7pIVSGzJje"
            },
            success:(resp)=>{
              if(resp.response_code == 200){
                $("#area_id").html(`<option value="">-select-</option>`);
                $.each(resp.data, (i,v)=>{
                    $("#area_id").append(`<option value="${v.id}">${v.area_name}</option>`);
                });
              }
            }
        });

        // well type list section 
        $.ajax({
            url: api_path + "Master/get_well_type_List",
            type: "POST",
            data:{company_id:company_id},
            headers: { 
                "x-api-key": "Qm0Lkq9m8JRiGPxO56HNmD7pIVSGzJje"
            },
            success:(resp)=>{
              if(resp.response_code == 200){
                $("#well_type").html(`<option value="">-select-</option>`);
                $.each(resp.data, (i,v)=>{
                    $("#well_type").append(`<option value="${v.id}">${v.well_type_name}</option>`);
                });
              }
            }
        });

      });

      const getSiteList = ()=>{
        let company_id = userData.company_id;
        let assets_id = userData.assets_id;
        let area_id = $("#area_id").val();

        $.ajax({
            url: api_path + "Well_site_master/Well_SiteList",
            type: "POST",
            data: {company_id:company_id,assets_id:assets_id,area_id:area_id},
            headers: { 
                "x-api-key": "Qm0Lkq9m8JRiGPxO56HNmD7pIVSGzJje"
            },
            success:(resp)=>{
              if(resp.response_code == 200){
                $("#site_id").html(`<option value="">-select-</option>`);
                $.each(resp.data, (i,v)=>{
                    $("#site_id").append(`<option value="${v.id}">${v.well_site_name}</option>`);
                });
              }
            }
        });
      }

      const getWellNames = ()=>{
        let company_id = userData.company_id;
        let assets_id = userData.assets_id;
        let area_id = $("#area_id").val();
        let site_id = $("#site_id").val();

        $.ajax({
            url: api_path + "Well_master/Well_List",
            type: "POST",
            data: {company_id:company_id,assets_id:assets_id,area_id:area_id,site_id:site_id},
            headers: { 
                "x-api-key": "Qm0Lkq9m8JRiGPxO56HNmD7pIVSGzJje"
            },
            success:(resp)=>{
              if(resp.response_code == 200){
                $("#well_id").html(`<option value="">-select-</option>`);
                $.each(resp.data, (i,v)=>{
                    $("#well_id").append(`<option value="${v.id}">${v.well_name}</option>`);
                });
              }
            }
        });

      }

      const get_dashboard_counts = ()=>{
          let company_id = userData.company_id;
          let area_id = $("#area_id").val();
          let well_id = $('#well_id').val();
          let well_type = $('#well_type').val();
          let site_id = $("#site_id").val();

          $.ajax({
              url: api_path + "Area_Dashboard/get_Total_InstalledSite",
              type: "POST",
              data: {
                company_id: company_id,
                area_id: area_id,
                site_id: site_id,
                well_id: well_id,
                well_type: well_type,
              },
              headers: { 
                  "x-api-key": "Qm0Lkq9m8JRiGPxO56HNmD7pIVSGzJje"
              },
              success:(resp)=>{
                // console.log(resp);
                if (resp.response_code == 200) {
                    $("#total_well").html(resp.data.total_well ? resp.data.total_well : "0");
                    $("#total_flowing_well").html(resp.data.total_flowing_well ? resp.data.total_flowing_well : "0");
                    $("#total_non_flowing_well").html(resp.data.total_non_flowing_well ? resp.data.total_non_flowing_well : "0");
                    $("#Off_well").html(resp.data.Off_well ? resp.data.Off_well : "0");

                    $("#cgl_well").html(
                        (resp.data.cgl_well?.cgl_flowing_well ? resp.data.cgl_well.cgl_flowing_well : "0") +
                        "|" +
                        (resp.data.cgl_well?.total_cgl ? resp.data.cgl_well.total_cgl : "0")
                    );

                    $("#igl_well").html(
                        (resp.data.igl_well?.igl_flowing_well ? resp.data.igl_well.igl_flowing_well : "0") +
                        "|" +
                        (resp.data.igl_well?.total_igl ? resp.data.igl_well.total_igl : "0")
                    );

                    $("#self_flow_well").html(
                        (resp.data.self_flow_well?.self_flowing_well ? resp.data.self_flow_well.self_flowing_well : "0") +
                        "|" +
                        (resp.data.self_flow_well?.total_self_flow ? resp.data.self_flow_well.total_self_flow : "0")
                    );

                    $("#Total_Count").html(resp.data.total_well ? resp.data.total_well : "0");
                }

              }
          });
      }

      const get_dashboard_well_details = ()=>{
        let area_id = $('#area_id').val();
        let well_id = $('#well_id').val();
        let well_type = $('#well_type').val();
        let site_id = $('#site_id').val();

        $.ajax({
            url: api_path + 'Area_Dashboard/Dashboard_Well_Details',
            method: 'POST',
            data: {
                area_id: area_id,
                well_id: well_id,
                well_type: well_type,
                site_id:site_id
            },
            headers: { 
                "x-api-key": "Qm0Lkq9m8JRiGPxO56HNmD7pIVSGzJje"
            },
            success: function (resp) {
              if (resp.response_code == 200) {
                  if (resp.data.length > 0) {
                      $("#well_area_card").html(''); // Clear previous content
                      $.each(resp.data, (i, v) => {
                          // Extracting values
                          let last_updated_time = v.Log_Date_Time;
                          let flag_status = v.flag_status;

                          let flowingWells = `<a href="javascript:;" onclick="single_dashboard_details(this.id)" id="${v.well_id}|${v.site_id}" class="btn btn-success">${v.well_name}</a>`;
                          let offlinewells = `<a href="javascript:;" onclick="single_dashboard_details(this.id)" id="${v.well_id}|${v.site_id}" class="btn btn-danger">${v.well_name}</a>`;
                          let nonFlowingWells = `<a href="javascript:;" onclick="single_dashboard_details(this.id)" id="${v.well_id}|${v.site_id}" class="btn btn-warning">${v.well_name}</a>`;
                          let appendedContent = '';

                          if (!last_updated_time) {
                              // If no last updated time, mark as offline
                              appendedContent = offlinewells;
                          } else {
                              // Check the time difference
                              let lastLogDateTime = new Date(last_updated_time);
                              let currentTime = new Date();
                              let timeDifference = (currentTime - lastLogDateTime) / (1000 * 60); // Difference in minutes

                              if (timeDifference > 120) {
                                  appendedContent = offlinewells;
                              }else if(timeDifference < 120){
                                  if (flag_status == 0){
                                      appendedContent = nonFlowingWells;
                                  }else if (flag_status == 1){
                                      appendedContent = flowingWells;
                                  }
                              }
                          }

                          // Append the generated content to the card
                          $("#well_area_card").append(appendedContent);
                      });
                  } else {
                      // No data case
                      $("#well_area_card").html('<div style="text-align: center;">No wells found!</div>');
                  }
              }
            }
        });
      }

      const initMap = ()=>{
        let area_id = $('#area_id').val();
        let well_id = $('#well_id').val();
        let well_type = $('#well_type').val();
        let site_id = $('#site_id').val();

        $.ajax({
              url: api_path + "Area_Dashboard/SiteList_for_Map",
              type: "POST",
              data: {
                area_id: area_id,
                well_id: well_id,
                well_type: well_type,
                site_id:site_id
              },
              headers: { 
                  "x-api-key": "Qm0Lkq9m8JRiGPxO56HNmD7pIVSGzJje"
              },
              success:(resp)=>{

                  if(resp.response_code == 200){
                    if(resp.data.length > 0){
                      let markers = [];
                      for (item of resp.data) {
                          markers.push({
                              position: { lat: parseFloat(item.lat), lng: parseFloat(item.long) },
                              title: item.well_name,
                              well_id: item.well_id,
                              offline_time: item.Log_Date_Time,
                              flag_status: item.flag_status,
                              long: item.long,
                              lat: item.lat,
                              site:item.site_id
                          });
                      }

                      var map = new google.maps.Map(document.getElementById('mymap'), {
                          zoom: 13,
                          center: { lat: 21.6316586, lng: 72.994056 }
                      });


                      markers.forEach(function (marker) {
                          var markerIcon = {
                              url: 'assets/images/red.png', 
                              scaledSize: new google.maps.Size(20, 20)
                          };

                          var seconds = 200;

                          if (marker.offline_time) {
                             
                              var lastDataTimeObj = new Date(marker.offline_time);
                              var currentDate = new Date();

                              var diffInMilliseconds = currentDate - lastDataTimeObj;
                              seconds = Math.floor(diffInMilliseconds / 1000);
                          }

                          if (!marker.offline_time || seconds > 7200) {
                              markerIcon.url = 'assets/images/red.png'; 
                          } else if (seconds <= 7200 && marker.flag_status == 0) {
                            
                              markerIcon.url = 'assets/images/green.png'; 
                          } else if (seconds <= 7200 && marker.flag_status == 1) {
                              
                              markerIcon.url = 'assets/images/orange.png'; 
                          }

                          var mapMarker = new google.maps.Marker({
                              position: marker.position,
                              map: map,
                              icon: markerIcon,
                              title: marker.title,
                              lat: marker.lat,
                              long: marker.long,
                              site:marker.site
                          });

                          var statusText = '';
                          if (!marker.offline_time || seconds > 7200) {
                              statusText = 'Offline';
                          } else if (seconds <= 7200 && marker.flag_status == 0) {
                              statusText = 'Flowing Well';
                          } else if (seconds <= 7200 && marker.flag_status == 1) {
                              statusText = 'Non-Flowing';
                          }

                        
                          var infowindow = new google.maps.InfoWindow({
                              content:
                                  '<div class="site-info" style="width: 150px; height: auto;">' +
                                  '<h6 style="color:black;"><a target="_blank" href="https://www.google.com/maps/place/' + marker.lat + ',' + marker.long + '" style="color:blue;">View on Google Maps</a></h6>' +
                                  '<h6>' + marker.title + '</h6>' +
                                  '<h6><b>Well Status</b>: ' + statusText + '</h6>' +
                                  '<h6><b><a onclick="single_dashboard_details(this.id)" id="'+marker.well_id+' | '+marker.site+'" href="javascript:;" style="color: blue;">View Details</a></b></h6>' +
                                  '</div>'
                          });

                          // Marker click listener
                          mapMarker.addListener('click', function () {
                              infowindow.open(map, mapMarker);
                          });

                          // Close InfoWindow on map click
                          map.addListener('click', function () {
                              infowindow.close();
                          });
                      });

                    }
                  }
              }
        });

      }

      const single_dashboard_details = (datas)=>{
        let [well_id, site_id] = datas.split("|");
        let well_siteId = [];
        well_siteId = {
            well_id: well_id,
            site_id: site_id,
        };
        localStorage.setItem('setWellSiteId',JSON.stringify(well_siteId));
        window.location.href = 'single_well_dashboard.html';
      }

      $(document).ready(function() {
        let sessionUserData = localStorage.getItem('userData');
        let userData = JSON.parse(sessionUserData);
        $("#logedin_user").html(userData.company_name);
      });

      const logoutSession = ()=>{
        localStorage.clear()
        window.location.href = 'login.html';
      }

      const setIdsToSession = (wellTypes) => {
          let wellSession_ids = {};
          wellSession_ids = {
              area_id: $("#well_id").val(),
              site_id: $("#site_id").val(),
              well_type: $("#well_type").val(),
              well_id: $("#well_id").val(),
          };
          localStorage.setItem('wellSessionIds',JSON.stringify(wellSession_ids));
          if(wellTypes == "totalWells"){
            window.location.href = 'total_well_list.html';
          }else if(wellTypes == "flowingWellsCard"){
            window.location.href = 'flowing_wells_list.html';
          }else if(wellTypes == "nonFlowingWells"){
            window.location.href = 'non_flowing_wells_list.html';
          }else if(wellTypes == "offlineWells"){
            window.location.href = 'offline_wells_list.html';
          }else if(wellTypes == "cglWells"){
            window.location.href = 'cgl_well_list.html';
          }
          
      };

      get_dashboard_counts();
      // get_dashboard_well_details();
      // initMap();
    </script>

  </body>


<!-- Mirrored from www.bootstrapget.com/demos/templatemonster/medicare-admin-dashboard/form-inputs.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 16 Sep 2024 17:59:06 GMT -->
</html>