
<!DOCTYPE html>
<html lang="en">

  
<!-- Mirrored from www.bootstrapget.com/demos/templatemonster/medicare-admin-dashboard/form-inputs.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 16 Sep 2024 17:59:06 GMT -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ONGC :: Ankleshwar</title>

    <!-- Meta -->
    <meta name="description" content="Marketplace for Bootstrap Admin Dashboards">
    <meta name="author" content="Bootstrap Gallery">
    <link rel="canonical" href="https://www.bootstrap.gallery/">
    <meta property="og:url" content="https://www.bootstrap.gallery/">
    <meta property="og:title" content="Admin Templates - Dashboard Templates | Bootstrap Gallery">
    <meta property="og:description" content="Marketplace for Bootstrap Admin Dashboards">
    <meta property="og:type" content="Website">
    <meta property="og:site_name" content="Bootstrap Gallery">
    <link rel="shortcut icon" href="assets/images/icons/logo.png">

    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css">

    <!-- *************
		************ CSS Files *************
	************* -->
    <link rel="stylesheet" href="assets/fonts/remix/remixicon.css">
    <link rel="stylesheet" href="assets/css/main.min.css">
    <link rel="stylesheet" type="text/css" href="assets/customecss/dashboard.css">
    <link href="assets/local/select2/css/select2.min.css" rel="stylesheet" type="text/css" />

    <!-- *************
		************ Vendor Css Files *************
	************ -->

    <!-- Scrollbar CSS -->
    <link rel="stylesheet" href="assets/vendor/overlay-scroll/OverlayScrollbars.min.css">

    <style type="text/css">
      table thead tr th{
        background-color: #ecf3f9ed !important;
      }
      .select2-selection.select2-selection--single{
        height: 35px !important;
      }
      .select2-selection__rendered{
        margin-top: 2px;
      }
      .select2-container--default .select2-selection--single .select2-selection__arrow{
        top: 5px;
        right: 8px;
      }
    </style>

  </head>

  <body>

    <!-- Page wrapper starts -->
    <div class="page-wrapper">

      <!-- App header starts -->
      <div class="app-header d-flex align-items-center">

        <!-- Toggle buttons starts -->
        <div class="d-flex">
          <button class="toggle-sidebar">
            <i class="ri-menu-line"></i>
          </button>
          <button class="pin-sidebar">
            <i class="ri-menu-line"></i>
          </button>
        </div>
        <!-- Toggle buttons ends -->

        <!-- App brand starts -->
        <div class="app-brand ms-3">
          <a href="index.html" class="d-lg-block d-none">
            <img src="assets/images/icons/logo.png" class="logo">
          </a>
        </div>
        <!-- App brand ends -->

        <!-- App header actions starts -->
        <div class="header-actions">

          <!-- Header user settings starts -->
          <div class="dropdown ms-2">
            <a id="userSettings" class="dropdown-toggle d-flex align-items-center" href="#!" role="button"
              data-bs-toggle="dropdown" aria-expanded="false">
              <div class="avatar-box"><i class="fa-solid fa-user"></i></div>
            </a>
            <div class="dropdown-menu dropdown-menu-end shadow-lg">
              <div class="px-3 py-2">
                <h6 class="m-0">Admin</h6>
              </div>
              <div class="mx-3 my-2 d-grid">
                <a href="login.html" class="btn btn-danger">Logout</a>
              </div>
            </div>
          </div>
          <!-- Header user settings ends -->

        </div>
        <!-- App header actions ends -->

      </div>
      <!-- App header ends -->

      <!-- Main container starts -->
      <div class="main-container">

        <!-- Sidebar wrapper starts -->
        <nav id="sidebar" class="sidebar-wrapper">

          <!-- Sidebar menu starts -->
          <div class="sidebarMenuScroll">
            <ul class="sidebar-menu">
              <li class="active current-page">
                <a href="main_dashboard.html">
                  <i class="ri-home-6-line"></i>
                  <span class="menu-text">Dashboard</span>
                </a>
              </li>
              <li class="treeview">
                <a href="#!">
                  <i class="ri-bar-chart-line"></i>
                  <span class="menu-text">Reports</span>
                </a>
                <ul class="treeview-menu">
                  <li>
                    <a href="historical_log.html">Historical </a>
                  </li>
                  <li>
                    <a href="alert_log_report.html">Historical Log Report</a>
                  </li>
                  <li>
                    <a href="historical_graph.html">Historical Graph Report</a>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
          <!-- Sidebar menu ends -->
        </nav>
        <!-- Sidebar wrapper ends -->

        <!-- App container starts -->
        <div class="app-container">

          <!-- App hero header starts -->
          <div class="app-hero-header d-flex align-items-center">

            <!-- Breadcrumb starts -->
            <ol class="breadcrumb">
              <li class="breadcrumb-item">
                <i class="ri-home-8-line lh-1 pe-3 me-3 border-end"></i>
                <a href="#">Home</a>
              </li>
              <li class="breadcrumb-item text-primary" aria-current="page">
                Reports
              </li>
              <li class="breadcrumb-item text-primary" aria-current="page">
                Historical Graph Report
              </li>
            </ol>
            <!-- Breadcrumb ends -->

          </div>
          <!-- App Hero header ends -->

          <!-- App body starts -->
          <div class="app-body">

            <!-- Row starts -->
            <div class="row gx-3">
              <div class="col-sm-12">
                <div class="card mb-3">
                  <div class="card-header" style="margin-bottom: -25px;">
                    <h5 class="card-title" style="font-family: sans-serif;font-weight: 700;">
                     Historical Report
                      <a href="single_well_dashboard.html" class="btn btn-sm btn-primary" style="float: right;">Back</a>
                    </h5>
                  </div>
                  <div class="card-body">
                    <div class="alert-filters">
                      <div class="row">
                        <div class="col-md-12 pt-1">
                          <div class="form-group">
                            <label><strong>Well Type</strong></label>
                            <select class="form-control select2" onchange="getWellName_list()" name="well_type" id="well_type">
                              
                            </select>
                          </div>
                        </div>
                        <div class="col-md-12 pt-1">
                          <div class="form-group">
                            <label><strong>Well Name</strong></label>
                            <select class="form-control select2" onchange="GetGraph()" name="well_id" id="well_id">
                              
                            </select>
                          </div>
                        </div>
                        <div class="col-md-12 pt-1">
                          <div class="form-group">
                            <label><strong>Report Type</strong></label>
                            <select class="form-control select2" onchange="GetGraph()" name="report_type" id="report_type">
                              <option value="">-select-</option>
                              <option value="1">CHP</option>
                              <option value="2">THP</option>
                              <option value="3">ABP</option>
                              <option value="4">GIP</option>
                              <option value="5">THT</option>
                              <option value="6">Battery</option>
                            </select>
                          </div>
                        </div>
                        <div class="col-md-12 pt-1">
                          <div class="form-group">
                            <label><strong>From Date</strong></label>
                            <input type="date" name="from_date" onchange="GetGraph()" id="from_date" class="form-control">
                          </div>
                        </div>
                        <div class="col-md-12 pt-1">
                          <div class="form-group">
                            <label><strong>To Date</strong></label>
                            <input type="date" name="to_date" onchange="GetGraph()" id="to_date" class="form-control">
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row gx-3">
              <div class="col-sm-12">
                <div class="card mb-3">
                  <div class="card-body" style="padding: 8px 8px;">
                    <div id="processing_message" style="display: none;">
                      <img src="assets/loader_img.svg" class="loader-img" alt="Loader" style="height:200px;width:100px;align-items: center;">
                    </div>
                    <span style="color: black;" id="selected_field"></span>
                    <canvas id="speedChart" width="600" height="400"></canvas>
                  </div>
                </div>
              </div>
            </div>

            <!-- Row ends -->

          </div>
          <!-- App body ends -->

          <!-- App footer starts -->
          <div class="app-footer bg-white">
            <span>© Copyright, Iotas Solutions Pvt Ltd, All Right Reserve. </span>
          </div>
          <!-- App footer ends -->

        </div>
        <!-- App container ends -->

      </div>
      <!-- Main container ends -->

    </div>
    <!-- Page wrapper ends -->

    <!-- *************
			************ JavaScript Files *************
		************* -->
    <!-- Required jQuery first, then Bootstrap Bundle JS -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/moment.min.js"></script>

    <!-- *************
			************ Vendor Js Files *************
		************* -->
    <script type="text/javascript" src="inc/paths.js"></script>
    <script src="assets/local/select2/js/select2.min.js"></script>
    <!-- Overlay Scroll JS -->
    <script src="assets/vendor/overlay-scroll/jquery.overlayScrollbars.min.js"></script>
    <script src="assets/vendor/overlay-scroll/custom-scrollbar.js"></script>

    <!-- Custom JS files -->
    <script src="assets/js/custom.js"></script>
    <!-- <script src="inc/sidebarmenu.html"></script> -->

    <script type="text/javascript">

      let sessionUserData = localStorage.getItem('userData');
      let userData = JSON.parse(sessionUserData);

      $(document).ready(function(){

        $(".select2").select2();

        $.ajax({
            url: api_path + "Master/get_well_type_List",
            type: "POST",
            data: {
                company_id: userData.company_id,
                user_id: userData.user_id,
            },
            headers: {
                "x-api-key": "Qm0Lkq9m8JRiGPxO56HNmD7pIVSGzJje"
            },
            success:(resp)=>{
              if(resp.response_code == 200){
                if(resp.data.length > 0){
                  $("#well_type").html(`<option value="">-select-</option>`);
                  $.each(resp.data, (i,v)=>{
                      $("#well_type").append(`<option value="${v.id}">${v.well_type_name}</option>`);
                  });
                }else{
                  $("#well_type").html(`<option value="">-select-</option>`)
                }
              }
            }
        });

      });

      const getWellName_list = ()=>{
        $.ajax({
            url: api_path + "Area_Dashboard/WellList_forDashboard",
            type: "POST",
            data: {
                company_id: userData.company_id,
                user_id: userData.user_id,
                well_type: $("#well_type").val(),
            },
            headers: {
                "x-api-key": "Qm0Lkq9m8JRiGPxO56HNmD7pIVSGzJje"
            },
            success:(resp)=>{
              if(resp.response_code == 200){
                if(resp.data.length > 0){
                  $("#well_id").html(`<option value="">-select-</option>`);
                  $.each(resp.data, (i,v)=>{
                      $("#well_id").append(`<option value="${v.well_id}">${v.well_name}</option>`);
                  });
                }else{
                  $("#well_id").html(`<option value="">-select-</option>`)
                }
              }
            }
        });
      }

      const graph_date_time = ()=>{
          const now = new Date();
          function formatDateToLocalInput(date) {
              const year = date.getFullYear();
              const month = String(date.getMonth() + 1).padStart(2, '0'); // Months are 0-based
              const day = String(date.getDate()).padStart(2, '0');
              const hours = String(date.getHours()).padStart(2, '0');
              const minutes = String(date.getMinutes()).padStart(2, '0');
              return `${year}-${month}-${day}`;
          }
          const toDateValue = formatDateToLocalInput(now);
          const fromDateValue = formatDateToLocalInput(new Date(now.getTime()));
          document.getElementById('from_date').value = fromDateValue;
          document.getElementById('to_date').value = toDateValue;
      }

      function get_installation_date()
      {
          var from_date = $('#from_date').val();
          var to_date = $('#to_date').val();

          f_from_date = moment(from_date);
          t_to_date = moment(to_date);

          if(f_from_date.isValid())
          {
              $('#report_from_date').text(f_from_date.format("DD-MM-YYYY"));
              $('#to').show();
          }else{
              $('#report_from_date').text('');
          }

          if(t_to_date.isValid())
          {
              $('#report_to_date').text(t_to_date.format("DD-MM-YYYY"));
              $('#to').show();
          }else{
              $('#report_to_date').text('');
          }

          // Additional check to show only the 'from date' if from_date == to_date
            if (f_from_date.isValid() && t_to_date.isValid() && f_from_date.isSame(t_to_date, 'day')) {
              $('#report_to_date').text('');
              $('#to').hide();

            }
      }

  function GetGraph() {

    var selectedOption = $("#alert_type").val(); // Corrected usage
    var processingMessage = document.getElementById("processing_message");

    if (!processingMessage) {
        console.error("Processing message element was not found.");
        return;
    }

    processingMessage.style.display = "block";

    var well_ids = $('#well_id').val();
    var well_type = $('#well_type').val();
    var from_date = $('#from_date').val();
    var to_date = $('#to_date').val();

    var url = '';
    var selectedText = ''; // Corrected variable name
    switch (selectedOption) {
        case "1":
            selectedText = 'CHP';
            url = api_path + 'Historical_report_c/get_graph_histrorical';
            break;
        case "2":
            selectedText = 'THP';
            url = api_path + 'Historical_report_c/get_graph_histrorical';
            break;
        case "3":
            selectedText = 'ABP';
            url = api_path + 'Historical_report_c/get_graph_histrorical';
            break;
        case "4":
            selectedText = 'GIP';
            url = api_path + 'Historical_report_c/get_graph_histrorical';
            break;
        case "5":
            selectedText = 'THT';
            url = api_path + 'Historical_report_c/get_graph_histrorical';
            break;
        case "6":
            selectedText = 'Battery';
            url = api_path + 'Historical_report_c/get_graph_histrorical';
            break;
        default:
            // console.error("Invalid selection option");
            processingMessage.style.display = "none";
            return;
    }

    $.ajax({
        url: url,
        type: 'POST',
        data: {
            well_id: well_ids,
            well_type: well_type,
            from_date: from_date,
            to_date: to_date,
            graph_type: selectedOption
        },
        success: function(res) {
            console.log(res, "graph data");
            processingMessage.style.display = "none";

            try {
                if (typeof res === 'string') {
                    res = JSON.parse(res);
                }
            } catch (e) {
                console.error("Error parsing JSON response:", e);
                return;
            }

            if (!res || !res.data) {
                console.error('API response is missing "data" property:', res);
                return;
            }

            var datasets = [];
            var labels = [];
            var colors = ["#FF5733", "#33FF57", "#3357FF", "#FF33A1", "#FF8C33"];

            Object.keys(res.data).forEach(function(wellId, index) {
                var wellData;
                switch (selectedOption) {
                    case "1":
                        wellData = res.data[wellId].output_chp.output_chp;
                        break;
                    case "2":
                        wellData = res.data[wellId].output_thp.output_thp;
                        break;
                    case "3":
                        wellData = res.data[wellId].output_abp.output_abp;
                        break;
                    case "4":
                        wellData = res.data[wellId].output_gip.output_gip;
                        break;
                    case "5":
                        wellData = res.data[wellId].output_tht.output_tht;
                        break;
                    case "6":
                        wellData = res.data[wellId].output_battery.output_battery;
                        break;
                }

                if (!wellData || wellData.length === 0 || !wellData[0].well_name) {
                    console.warn(`No data found for well ID: ${wellId}`);
                    return;
                }

                var dataPoints = wellData.map(function(point) {
                    return {
                        x: new Date(point.x).getTime(),
                        y: parseFloat(point.y)
                    };
                });

                labels = wellData.map(function(point) {
                    return point.x;
                });

                var color = colors[index] || getRandomColor();

                datasets.push({
                    label: wellData[0].well_name + " - " + selectedText,
                    data: dataPoints,
                    lineTension: 0,
                    fill: false,
                    borderColor: color
                });
            });

            updateLineChart(datasets, labels);
        },
        error: function(xhr, status, error) {
            processingMessage.style.display = "none";
            console.error('AJAX Error: ', error);
        }
    });
}

function updateLineChart(datasets, labels) {
    var speedCanvas = document.getElementById("speedChart");

    if (window.lineChart) {
        window.lineChart.destroy();
    }

    window.lineChart = new Chart(speedCanvas, {
        type: 'line',
        data: {
            labels: labels,
            datasets: datasets
        },
        options: {
            plugins: {
                legend: {
                    display: true,
                    position: 'top',
                    labels: {
                        boxWidth: 80,
                        color: 'black'
                    }
                }
            },
            scales: {
                x: {
                    type: 'time',
                    time: {
                        displayFormats: {
                            minute: 'HH:mm:ss',
                            hour: 'HH:mm'
                        }
                    }
                }
            }
        }
    });
}

function getRandomColor() {
    var letters = '0123456789ABCDEF';
    var color = '#';
    for (var i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * 16)];
    }
    return color;
}


      graph_date_time();
      get_installation_date();
      // GetGraph();
    </script>

  </body>


<!-- Mirrored from www.bootstrapget.com/demos/templatemonster/medicare-admin-dashboard/form-inputs.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 16 Sep 2024 17:59:06 GMT -->
</html>